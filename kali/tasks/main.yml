---
# tasks file for kali

- name: Install Pure Ftpd
  apt:
    name: pure-ftpd 

- name: Install Mingw
  apt:
    name: mingw-w64

- name: Install GDB
  apt:
    name: gdb

- name: Install JDK
  apt:
    name: default-jdk

- name: Install MSSql Packages
  apt:
    name:
      - sqsh
      - freetds-bin
      - freetds-common
      - freetds-dev

- name: Install Gobuster
  apt:
    name: gobuster

- name: Install Seclists
  apt:
    name: seclists

- name: Setup Vimrc
  template:
    src: .vimrc.j2
    dest: ~/.vimrc  

- name: Setup gnome terms
  template:
    src: open_gnometerms.desktop.j2
    dest: /usr/share/applications/open_gnometerms.desktop

- name: Copy gnome script
  copy:
    src: "{{gnome_script}}"
    dest: "{{gnome_loc}}/{{gnome_script}}" 
    mode: "0755"

- name: Create directory for gnome files
  file:
    path: "{{gnome_dir}}"
    state: directory 

- name: Copy gnome png
  copy:
    src: "{{gnome_pic}}"
    dest: "{{gnome_dir}}/{{gnome_pic}}"

- name: How to recognized gnometerms desktop app
  debug:
    msg: "alt f2 & type restart"

- name: Create Pastables directory
  file:
    path: "{{pastables_dir}}"
    state: directory

- name: Get pastables
  git:
    repo: https://github.com/wshenk/pastables.git
    dest: "{{pastables_dir}}"

- name: Create pwndbg dir
  file:
    path: "{{pwndbg_dir}}"
    state: directory

- name: Get pwndbg
  git:
    repo: https://github.com/pwndbg/pwndbg.git
    dest: "{{pwndbg_dir}}"

- name: Check for pwndb install
  lineinfile:
    name: ~/.gdbinit
    line: "source {{pwndbg_dir}}/gdbinit.py"
    state: present
  check_mode: present
  register: pwndbg_install    

- name: Install pwndbg
  shell: ./setup.sh
  args:
    chdir: "{{pwndbg_dir}}"
  when: pwndbg_install.changed
 
- name: Create directory for ghidra
  file:
    path: "{{ghidra_dir}}"
    state: directory

- name: Download Ghidra 
  get_url:
    url: "{{ghidra_url}}"
    dest: "{{ghidra_dir}}"

- name: Unzip Ghidra
  unarchive:
    src: "{{ghidra_dir}}/{{ghidra_file}}.{{ghidra_ext}}"
    dest: "{{ghidra_dir}}"

- name: Link Ghidra
  file:
    src: "{{ghidra_dir}}/{{ghidra_version}}/ghidraRun"
    dest: "/usr/local/bin/ghidraRun"
    state: link

- name: Setup Ghidra
  template:
    src: ghidra.desktop.j2
    dest: /usr/share/applications/ghidra.desktop

- name: Init msfdb
  shell: "msfdb init"
  args:
    chdir: "~/"
